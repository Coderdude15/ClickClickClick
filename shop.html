<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Shop</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <h1>üõí Game Shop</h1>
  <h2>Your Points: <span id="playerPoints">0</span></h2>

  <div class="shop-item">
    <h3>Auto Clicker</h3>
    <p>Cost: 5000 points</p>
    <button id="buyAutoClicker">Buy</button>
  </div>

  <div class="shop-item">
    <h3>+5 Clicks per Click</h3>
    <label>Duration:</label>
    <select id="bonus5Duration">
      <option value="600000" data-cost="800">10 Minutes (800 points)</option>
      <option value="1800000" data-cost="1500">30 Minutes (1500 points)</option>
      <option value="0" data-cost="4000">Infinite (for this session) (4000 points)</option>
    </select>
    <button id="buyPlus5">Buy</button>
  </div>

  <div class="shop-item">
    <h3>+10 Clicks per Click</h3>
    <label>Duration:</label>
    <select id="bonus10Duration">
      <option value="600000" data-cost="1800">10 Minutes (1800 points)</option>
      <option value="1800000" data-cost="2600">30 Minutes (2600 points)</option>
      <option value="0" data-cost="6500">Infinite (for this session) (6500 points)</option>
    </select>
    <button id="buyPlus10">Buy</button>
  </div>

  <div class="shop-item">
    <h3>üé® Custom Backgrounds</h3>
    <p>Cost: FREE (Must Unlock Each)</p>
    <button id="buyBackground">Buy</button>
  </div>

  <div id="bgPicker" style="display:none; margin-top: 20px;">
    <h3>Choose a Background</h3>
    <select id="bgSelect">
      <option value="url('https://th.bing.com/th/id/OIP.sOvyBWSIX6YhVGKVRtOIpQHaEK?w=299&h=150&c=6&o=7&pid=1.7&rm=3')" data-requirement="0">Default Background</option>
      <option value="url('https://th.bing.com/th/id/R.4844312b1079ee0b6bd1cd8f90bfbb60?rik=ApGEZ%2fi7yZDeLA&riu=http%3a%2f%2fwww.pixelstalk.net%2fwp-content%2fuploads%2f2016%2f08%2fSuper-cool-picture-backgrounds.jpg&ehk=sgEHfm4fVk4HT36alHTZyd8CFpN6JO%2bToNd%2berN5HZE%3d&risl=&pid=ImgRaw&r=0')" data-requirement="500000000000000000000000000000">Lake Night Background (Unlocks at 500 Nonillion score)</option>
      <option value="url('https://www.bing.com/th/id/OIP.YEGV8vCvIHciU0l99VtgEgHaEK?w=245&h=211&c=8&rs=1&qlt=90&o=6&pid=3.1&rm=2')" data-requirement="20000000">Forest Background (Unlocks at 20M score)</option>
      <option value="url('https://www.bing.com/th/id/OIP.QrTu35Ro2fZqkf9Usvp8tgHaEo?w=247&h=211&c=8&rs=1&qlt=90&o=6&pid=3.1&rm=2')" data-requirement="1000000000">City Night Background (Unlocks at 1B score)</option>
      <option value="url('https://wallpaperaccess.com/full/1128330.jpg')" data-requirement="50000000">Beach Background (Unlocks at 50M score)</option>
      <option value="url('https://th.bing.com/th/id/R.4d600e55c5e68eb06230eadc2b1f4456?rik=9pn4t%2brnIT9Y3g&riu=http%3a%2f%2fwallpapercave.com%2fwp%2fgbpDqB4.jpg&ehk=F%2fONuAxUrv61DbmF729rI3uHE5sy1SjQMr5jgyIO5g4%3d&risl=&pid=ImgRaw&r=0')" data-requirement="50000000">Horse Background (Unlocks at 50M score)</option>
      <option value="url('https://th.bing.com/th/id/OIP.RbpZKrr4epbKZVfgugBp5QHaEo?w=248&h=180&c=7&r=0&o=7&pid=1.7&rm=3')" data-requirement="100000000">Space Background (Unlocks at 100M score)</option>
    </select>
    <button id="applyBackground">Apply Background</button>
  </div>

  <button id="goBack">‚¨ÖÔ∏è Back to Game</button>

  <script>
    window.addEventListener("load", () => {
      let currentScore = parseInt(localStorage.getItem("CurrentScore")) || 0;

      // Calculate shop points: 300 points for every 50M score
      const shopPoints = Math.floor(currentScore / 50000000) * 300;
      document.getElementById("playerPoints").innerText = shopPoints;

      if (localStorage.getItem("backgroundPurchased") === "true") {
        document.getElementById("bgPicker").style.display = "block";
        updateBackgroundOptions(currentScore);
      }
      setInitialBackground();
    });

    function setInitialBackground() {
      const bg = localStorage.getItem("selectedBackground");
      document.body.style.backgroundImage = bg && bg !== "none" ? bg : "url('https://th.bing.com/th/id/OIP.sOvyBWSIX6YhVGKVRtOIpQHaEK?w=299&h=150&c=6&o=7&pid=1.7&rm=3')";
    }

    function buyItem(itemName) {
      let currentScore = parseInt(localStorage.getItem("CurrentScore")) || 0;
      let shopPoints = Math.floor(currentScore / 50000000) * 300;
      let cost = 0;

      if (itemName === "plus5") {
        const select = document.getElementById("bonus5Duration");
        cost = parseInt(select.selectedOptions[0].dataset.cost);
      } else if (itemName === "plus10") {
        const select = document.getElementById("bonus10Duration");
        cost = parseInt(select.selectedOptions[0].dataset.cost);
      } else if (itemName === "autoClicker") cost = 5000;
      else if (itemName === "background") cost = 0;

      if (shopPoints < cost) return alert("‚ùå Not enough points!");
      shopPoints -= cost;
      document.getElementById("playerPoints").innerText = shopPoints;

      const inventory = JSON.parse(localStorage.getItem("Inventory")) || [];
      inventory.push(itemName);
      localStorage.setItem("Inventory", JSON.stringify(inventory));

      if (itemName === "autoClicker") {
        localStorage.setItem("autoClickerPending", "true");
        alert("‚úÖ Auto Clicker purchased!");
      }
      if (itemName === "plus5") chooseClickBonus(5);
      if (itemName === "plus10") chooseClickBonus(10);
      if (itemName === "background") {
        localStorage.setItem("backgroundPurchased", "true");
        document.getElementById("bgPicker").style.display = "block";
        updateBackgroundOptions(currentScore);
        alert("üé® Background selector unlocked!");
      }
    }

    function chooseClickBonus(amount) {
      const select = amount === 5 ? document.getElementById("bonus5Duration") : document.getElementById("bonus10Duration");
      const duration = parseInt(select.value);
      if (duration === 0) {
        sessionStorage.setItem("clickBonusAmount", amount);
        sessionStorage.removeItem("clickBonusExpiration");
        alert(`‚úÖ +${amount} clicks per click (infinite this session)!`);
      } else {
        sessionStorage.setItem("clickBonusAmount", amount);
        sessionStorage.setItem("clickBonusExpiration", Date.now() + duration);
        alert(`‚úÖ +${amount} clicks per click for ${duration / 60000} minutes!`);
      }
    }

    function updateBackgroundOptions(currentScore) {
      const select = document.getElementById("bgSelect");
      for (const option of select.options) {
        const requirement = parseInt(option.dataset.requirement);
        if (currentScore < requirement) {
          option.disabled = true;
          if (!option.textContent.includes(" üîí")) option.textContent += " üîí";
        } else {
          option.disabled = false;
          option.textContent = option.textContent.replace(" üîí", "");
        }
      }
    }

    document.getElementById("buyAutoClicker").addEventListener("click", () => buyItem("autoClicker"));
    document.getElementById("buyPlus5").addEventListener("click", () => buyItem("plus5"));
    document.getElementById("buyPlus10").addEventListener("click", () => buyItem("plus10"));
    document.getElementById("buyBackground").addEventListener("click", () => buyItem("background"));
    document.getElementById("applyBackground").addEventListener("click", () => {
      const bg = document.getElementById("bgSelect").value;
      localStorage.setItem("selectedBackground", bg);
      document.body.style.backgroundImage = bg;
      alert("‚úÖ Background applied!");
    });
    document.getElementById("goBack").addEventListener("click", () => window.location.href = "index.html");
  </script>

  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      background-color: black;
      color: aqua;
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center center;
      background-attachment: fixed;
    }
    h1 { font-size: 3rem; margin-bottom: 0; }
    h2 { font-size: 2rem; margin-top: 0; margin-bottom: 20px; }
    .shop-item {
      border: 2px solid aqua;
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 15px;
      background-color: rgba(0,0,0,0.6);
    }
    button {
      font-size: 1.2rem;
      padding: 10px 15px;
      border-radius: 5px;
      border: none;
      background-color: aqua;
      cursor: pointer;
    }
    button:hover { background-color: #00ffffcc; }
    select {
      background: black;
      color: aqua;
      border: 1px solid aqua;
      border-radius: 5px;
      margin-left: 5px;
    }
    #bgPicker {
      background-color: rgba(0,0,0,0.7);
      border: 2px solid aqua;
      padding: 15px;
      border-radius: 10px;
    }
  </style>

</body>
</html>
